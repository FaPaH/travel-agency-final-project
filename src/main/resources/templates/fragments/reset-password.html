<div th:fragment="reset-password-fragment" id="reset-container" class="p-3 border rounded bg-light">

    <div th:if="${success}" class="alert alert-success">
        <h5 class="alert-heading">Готово!</h5>
        <p th:text="${message}"></p>
        <button class="btn btn-sm btn-outline-secondary"
                hx-get="/user/profile"
                hx-target="#content-area">Назад в профиль</button>
    </div>

    <div th:if="${success == null}">
        <h4>Сброс пароля</h4>

        <form th:object="${resetRequest}"
              hx-post="/auth/reset-password"
              hx-target="#reset-container"
              hx-swap="outerHTML">

            <div th:if="${!hasEmail}" class="mb-3">
                <p class="text-warning">В вашем профиле не указана почта. Пожалуйста, введите её для получения ссылки:</p>
                <input type="email"
                       th:field="*{email}"
                       class="form-control"
                       placeholder="your-email@example.com"
                       th:classappend="${#fields.hasErrors('email')} ? 'is-invalid' : ''"
                       required>
                <div class="invalid-feedback" th:errors="*{email}">Ошибка почты</div>
            </div>

            <div th:if="${hasEmail}" class="mb-3">
                <p>Ссылка будет отправлена на вашу подтвержденную почту:
                    <strong th:text="${resetRequest.email}"></strong>
                </p>
                <input type="hidden" th:field="*{email}">
            </div>

            <button type="submit" class="btn btn-danger">
                [[${hasEmail} ? 'Отправить ссылку' : 'Подтвердить почту и отправить']]
            </button>
        </form>
    </div>
</div>